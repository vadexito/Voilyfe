<?php 
$this->headLink()->prependStylesheet('/css/lib/datebox.css');
$this->headScript()->offsetSetFile(100,'https://www.google.com/jsapi'); 
$this->headScript()->offsetSetFile(101,'/js/lib/jqm-datebox/datebox-core.js');
$this->headScript()->offsetSetFile(102,'/js/lib/jqm-datebox/datebox-core-modeCalbox.js');

$this->inlineScript()->offsetSetFile(40,'/js/lib/underscore.js');
$this->inlineScript()->offsetSetFile(50,'/js/lib/backbone.js');

$this->inlineScript()->offsetSetFile(150,'/js/mvc/views/eventListView.js');
$this->inlineScript()->offsetSetFile(151,'/js/mvc/views/indexView.js');


if ($this->events)
{
    echo $this->subPageIndex($this->category,'last-events-page',[
        'content'   => $this->partial(
            'partial/_pageLastEvents-mobile.phtml',
            ['events' => $this->events,'all'=>$this->allOption]
        ),
        'active'    => 'last-events',
    ]);
    
    echo $this->subPageIndex($this->category,'calendar-page',[
        'content'   => $this->partial(
            'partial/_pageCalendar-mobile.phtml',
            ['events' => $this->events,'eventsPerDay' => $this->eventsPerDay]
        ),
        'active'    => 'calendar',
    ]);
    
    echo $this->subPagesGraphIndex($this->category,$this->graphs($this->events,$this->allOption));
    
} 
else //if no event to show
{
    echo $this->subPageIndex($this->category,'last-events-page',[
        'content'   => $this->partial('partial/_welcome.phtml'),
        'active'    => 'last-events',
        'title'     => ucfirst($this->translate('msg_welcome')),
    ]);
}
    echo $this->subPageIndex($this->category,'list_singleCategories',[
        'content'   => $this->listCategories('partial/_categoriesNewEventMenu.phtml','eventAdd'),
        'title'     => ucfirst($this->translate('menu_add_event'))
    ]);
    
    echo $this->subPageIndex($this->category,'list_allCategories',[
        'content'   => $this->listCategories('partial/_categoriesMenu.phtml','metaCategory'),
        'title'     => ucfirst($this->translate('menu_see_categories')),
        'buttonLeft' => $this->htmlMobileButtonNavBar(['type' => 
            Pepit_View_Helper_HtmlMobileButtonNavBar::TYPE_BUTTON_BACK],[],
                ucfirst($this->translate('menu_back_to_previous_page'))),
    ]);
    
    echo $this->subPageIndex($this->category,'options-page',[
        'content'   => $this->settingsMobile(),
        'title'     => ucfirst($this->translate('menu_settings')),
        'active'    => 'options',
        'buttonRight' => '',
    ]);
    echo $this->subPageIndex($this->category,'event-list-page',[
        'content'   => '<ul id="event-list" data-role="listview"></ul>',
        'title'     => 'blabla',
        'active'    => 'graphs',
        'buttonRight' => '',
    ]);
?>
     
    <span id="dataToClientSide" data-categoryId="<?php echo $this->category->id; ?>"></span>
    <script type="text/template" id="event-line-template">
        <li class="event-line">
            <a data-ajax="false" class="event-line-link" href="<%= href %>">
                <img  src="<%= imgSrc %>" />
                <h4><%= mainTitle %></h4>
                <p>
                    <strong>
                        <%= commonProperties %>
                    </strong>
                </p>
                <p>
                    <%= specificProperties %>
                </p>
                <p class="ui-li-aside"><strong><%= aside %></strong></p>  
            </a>
        </li>
    </script>
    <script type="text/template" id="event-property-template">
        <img src="/images/icons/nav_bar/<%= srcIcon %>" style="width:15px;height:15px;"/><%= content %>
    </script>
